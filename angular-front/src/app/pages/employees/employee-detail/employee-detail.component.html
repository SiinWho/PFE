<app-page-breadcrumb pageTitle="Employee Details" class="mb-8 block" />

<div *ngIf="employee" class="space-y-8 pb-12">
  <!-- Meta Card -->
  <div class="p-5 border border-gray-200 rounded-2xl bg-white dark:border-gray-800 dark:bg-white/[0.03] lg:p-8">
    <div class="flex flex-col gap-6 xl:flex-row xl:items-center xl:justify-between">
      <div class="flex flex-col items-center w-full gap-6 xl:flex-row xl:justify-start">
        <div class="w-28 h-28 sm:w-32 sm:h-32 overflow-hidden border border-gray-200 rounded-full dark:border-gray-800 shrink-0">
          <img [src]="employee.image" [alt]="employee.name" class="w-full h-full object-cover" />
        </div>
        <div class="text-center xl:text-left space-y-2">
          <h4 class="text-2xl font-bold text-gray-800 dark:text-white/90">
            {{ employee.name }}
          </h4>
          <div class="flex flex-col items-center gap-1 xl:flex-row xl:gap-3 xl:text-left">
            <p class="text-gray-500 dark:text-gray-400 font-medium">
              {{ employee.role }}
            </p>
            <div class="hidden h-3.5 w-px bg-gray-300 dark:bg-gray-700 xl:block"></div>
            <p class="text-gray-500 dark:text-gray-400">
              {{ employee.department }}
            </p>
          </div>
          <div class="flex justify-center xl:justify-start pt-2">
            <app-badge [color]="getBadgeColor(employee.status)">
              {{ employee.status }}
            </app-badge>
          </div>
        </div>
      </div>
      <div class="flex flex-wrap items-center justify-center gap-3 mt-4 xl:mt-0 xl:justify-end">
        <app-button variant="outline" size="sm" (btnClick)="onBack()" class="w-full sm:w-auto">
          Back to List
        </app-button>
        <app-button size="sm" [routerLink]="['/employees/edit', employee.id]" class="w-full sm:w-auto">
          Edit Profile
        </app-button>
      </div>
    </div>
  </div>

  <div class="grid grid-cols-1 gap-8 lg:grid-cols-3">
    <!-- Bio & Stats -->
    <div class="lg:col-span-2 space-y-8">
      <app-component-card title="About Employee" class="h-full">
        <div class="p-1">
          <p class="text-gray-500 dark:text-gray-400 leading-relaxed text-sm md:text-base">
            {{ employee.bio }}
          </p>
        </div>
      </app-component-card>

      <app-component-card title="Professional Details">
        <div class="grid grid-cols-1 gap-y-8 gap-x-4 sm:grid-cols-2 p-2">
            <div class="space-y-1">
              <p class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Department</p>
              <p class="text-base font-medium text-gray-800 dark:text-white/90">{{ employee.department }}</p>
            </div>
            <div class="space-y-1">
              <p class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Role</p>
              <p class="text-base font-medium text-gray-800 dark:text-white/90">{{ employee.role }}</p>
            </div>
            <div class="space-y-1">
              <p class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Reporting Manager</p>
              <p class="text-base font-medium text-primary-500 dark:text-primary-400">{{ employee.manager || 'N/A' }}</p>
            </div>
            <div class="space-y-1">
              <p class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Join Date</p>
              <p class="text-base font-medium text-gray-800 dark:text-white/90">{{ employee.joinDate | date:'longDate' }}</p>
            </div>
        </div>

        <div class="mt-8 border-t border-gray-100 dark:border-gray-800 pt-6">
          <p class="text-sm font-bold text-gray-800 dark:text-white/90 mb-4 px-2">Career History</p>
          <div class="space-y-6 px-2">
            <div *ngFor="let history of employee.careerHistory" class="relative pl-6 before:absolute before:left-0 before:top-2 before:w-2 before:h-2 before:bg-primary-500 before:rounded-full after:absolute after:left-[3px] after:top-4 after:w-[2px] after:h-full after:bg-gray-100 dark:after:bg-gray-800 last:after:hidden">
              <p class="text-sm font-bold text-gray-800 dark:text-white/90">{{ history.role }}</p>
              <div class="flex items-center gap-2 text-xs text-gray-500 mt-1">
                <span>{{ history.department }}</span>
                <span>â€¢</span>
                <span>{{ history.startDate | date:'MMM y' }} - {{ history.endDate ? (history.endDate | date:'MMM y') : 'Present' }}</span>
              </div>
            </div>
          </div>
        </div>
      </app-component-card>
    </div>

    <!-- Contact Info -->
    <div class="space-y-8">
      <app-component-card title="Contact Information" class="h-full">
        <div class="space-y-8 p-2">
          <div class="space-y-1">
            <p class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Email Address</p>
            <p class="text-base font-medium text-gray-800 dark:text-white/90 break-all">{{ employee.email }}</p>
          </div>
          <div class="space-y-1">
            <p class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Phone Number</p>
            <p class="text-base font-medium text-gray-800 dark:text-white/90">{{ employee.phone }}</p>
          </div>
          <div class="space-y-1">
            <p class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Work Location</p>
            <p class="text-base font-medium text-gray-800 dark:text-white/90">{{ employee.location }}</p>
          </div>
        </div>
      </app-component-card>

      <!-- Subordinates section -->
      <app-component-card *ngIf="employee.subordinates?.length" title="Team (Direct Reports)">
        <div class="space-y-4 p-2">
          <div *ngFor="let sub of employee.subordinates" class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-white/[0.02] cursor-pointer" [routerLink]="['/employees', sub.id]">
            <div class="w-10 h-10 overflow-hidden rounded-full border border-gray-100 dark:border-gray-800">
              <img [src]="sub.image" [alt]="sub.name" class="w-full h-full object-cover" />
            </div>
            <div>
              <p class="text-sm font-bold text-gray-800 dark:text-white/90">{{ sub.name }}</p>
              <p class="text-xs text-gray-500">{{ sub.role }}</p>
            </div>
          </div>
        </div>
      </app-component-card>
    </div>
  </div>
</div>

<div *ngIf="!employee" class="text-center py-20">
    <p class="text-gray-500">Loading employee details...</p>
</div>
